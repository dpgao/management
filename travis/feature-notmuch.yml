notifications:
  email:
    recipients:
      - rich@flatcap.org
    on_success: change
    on_failure: always

sudo: required
dist: trusty

language: c
compiler: gcc
cache: ccache

addons:
  apt:
    packages:
      - libnotmuch-dev
      - libtokyocabinet-dev

env:
    # Default config
  - OPTS=""
    # Enable components that default to 'off'
  - OPTS="--enable-notmuch"
  - OPTS="--enable-sidebar"
  - OPTS="--enable-sidebar --enable-notmuch"
    # Test all the backend caching options
  - OPTS="--enable-sidebar --enable-notmuch --enable-hcache --without-qdbm --without-gdbm --without-bdb"
  - OPTS="--enable-sidebar --enable-notmuch --enable-imap"

before_script:
  - ccache -z
  - autoreconf -i

script:
  - ./configure $OPTS
  - make
  - ./mutt -v

after_script:
  - ccache -s

